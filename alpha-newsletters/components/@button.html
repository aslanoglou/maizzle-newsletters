<script props>
  // https://maizzle.com/docs/components/button
  let align = {
    left: 'text-left',
    center: 'text-center',
    right: 'text-right',
  }[props.align] || ''

  let styles = [
    'display: inline-block;',
    'text-decoration: none;',
    'padding: 16px 24px;',
    'font-size: 16px;',
    'line-height: 1;',
    'border-radius: 4px;',
  ]

  let hasBgClass = () => props.class && props.class.split(' ').some(c => c.startsWith('bg-'))

  if (props['bgColor'] && !hasBgClass()) {
    styles.push(`background-color: ${props['bgColor']};`)
  } else {
    styles.push('background-color: #4338ca;')
  }

  if (props.color) {
    styles.push(`color: ${props.color};`)
  } else {
    styles.push('color: #ffffff;')
  }

  if (props['btnWidth']) {
    styles.push(`width: ${props.btnWidth};`)
  } else {
    styles.push('width: 273px;')
  }

  module.exports = {
    align,
    href: props.href,
    styles: styles.join(''),
    msoPt: props['mso-pt'] || '16px',
    msoPb: props['mso-pb'] || '24px',
  }
</script>

<table role="presentation" align="center" border="0" cellpadding="0" cellspacing="0">
  <tr>
    <td align="center">

      <!--[if mso]>
      <v:roundrect xmlns:v="urn:schemas-microsoft-com:vml"
                   xmlns:w="urn:schemas-microsoft-com:office:word"
                   href="{{{ href }}}"
                   style="height:48px;v-text-anchor:middle;width:{{{btnWidth}}};"
                   arcsize="50%" stroke="f" fillcolor="{{{bgColor}}}">
        <w:anchorlock/>
        <v:textbox inset="0,0,0,0">
          <center style="color:#ffffff; font-family:Arial, sans-serif; font-size:16px;">
      <![endif]-->
      <a href="{{{ href }}}" rel="noopener"
         style="font-family: Arial, sans-serif; font-size: 16px; margin: 0 auto; padding: 0 36px; color: {{color}} !important; line-height: 48px; background-color:{{bgColor}}; border-radius: 5000px; display: inline-block; text-align: center; text-decoration: none; white-space: nowrap; -webkit-text-size-adjust: none;"
         data-ogsc="color:rgba(255, 255, 255, 1);background-color:rgba(17, 54, 107, 1);"
         data-ogsb="color:rgba(255, 255, 255, 1);background-color:rgba(17, 54, 107, 1);">
        {{{btnText}}}
      </a>
      <!--[if mso]>
      </center>
      </v:textbox>
      </v:roundrect>
      <![endif]-->

    </td>
  </tr>
  <tr>
    <td>
      <!--[if mso]>
      <v:roundrect xmlns:v="urn:schemas-microsoft-com:vml" xmlns:w="urn:schemas-microsoft-com:office:word" rel="noopener"
                   target="_blank" rel="noopener" target="_blank" href="http://"
                   style="height:50px;v-text-anchor:middle; mso-wrap-style: none; mso-position-horizontal: center; mso-position-vertical: top;"
                   arcsize="50%" stroke="f" fillcolor="{{{bgColor}}}">
        <w:anchorlock/>
        <center>
      <![endif]-->
      <a href="http://litmus.com" rel="noopener" rel="noopener" style="background: rgba(17, 54, 107, 1);border-radius:5000px;color:#ffffff;display:inline-block;font-size: 18px; font-family: Helvetica, Arial, sans-serif;font-weight:bold;text-align:center;text-decoration:none;-webkit-text-size-adjust:none;padding: 14px 24px;" target="_blank"
         target="_blank">
        {{{btnText}}}
      </a>
      <!--[if mso]>
      </center>
      </v:roundrect>
      <![endif]-->
    </td>
  </tr>
</table>


